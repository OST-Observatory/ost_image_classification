* python main.py --epochs 30 --batch_size 32 --lr_schedule constant --initial_lr 1e-3

    Training:
        Epoch 1/30
        369/369 ━━━━━━━━━━━━━━━━━━━━ 0s 2s/step - accuracy: 0.2644 - loss: 2.00772025-09-10 15:14:56.166057: W external/local_xla/xla/tsl/framework/cpu_allocator_impl.cc:83] Allocation of 1443540000 exceeds
        10% of free system memory.
        369/369 ━━━━━━━━━━━━━━━━━━━━ 896s 2s/step - accuracy: 0.2644 - loss: 2.0069 - val_accuracy: 0.1212 - val_loss: 2.3117 - learning_rate: 0.0010
        Epoch 2/30
        369/369 ━━━━━━━━━━━━━━━━━━━━ 920s 2s/step - accuracy: 0.3336 - loss: 1.3939 - val_accuracy: 0.6174 - val_loss: 1.3284 - learning_rate: 0.0010
        Epoch 3/30
        369/369 ━━━━━━━━━━━━━━━━━━━━ 902s 2s/step - accuracy: 0.4255 - loss: 1.1825 - val_accuracy: 0.7091 - val_loss: 1.2567 - learning_rate: 0.0010
        Epoch 4/30
        369/369 ━━━━━━━━━━━━━━━━━━━━ 886s 2s/step - accuracy: 0.5178 - loss: 0.9889 - val_accuracy: 0.7332 - val_loss: 1.0462 - learning_rate: 0.0010
        Epoch 5/30
        369/369 ━━━━━━━━━━━━━━━━━━━━ 878s 2s/step - accuracy: 0.6137 - loss: 0.9336 - val_accuracy: 0.7206 - val_loss: 0.9098 - learning_rate: 0.0010
        Epoch 6/30
        369/369 ━━━━━━━━━━━━━━━━━━━━ 880s 2s/step - accuracy: 0.6585 - loss: 0.8295 - val_accuracy: 0.7600 - val_loss: 0.8283 - learning_rate: 0.0010
        Epoch 7/30
        369/369 ━━━━━━━━━━━━━━━━━━━━ 884s 2s/step - accuracy: 0.7046 - loss: 0.7389 - val_accuracy: 0.7536 - val_loss: 0.9745 - learning_rate: 0.0010
        Epoch 8/30
        369/369 ━━━━━━━━━━━━━━━━━━━━ 881s 2s/step - accuracy: 0.7205 - loss: 0.7822 - val_accuracy: 0.8269 - val_loss: 0.8328 - learning_rate: 0.0010
        Epoch 9/30
        369/369 ━━━━━━━━━━━━━━━━━━━━ 894s 2s/step - accuracy: 0.7462 - loss: 0.7476 - val_accuracy: 0.4002 - val_loss: 3.4016 - learning_rate: 0.0010
        Epoch 10/30
        369/369 ━━━━━━━━━━━━━━━━━━━━ 890s 2s/step - accuracy: 0.7662 - loss: 0.7300 - val_accuracy: 0.4817 - val_loss: 2.0893 - learning_rate: 0.0010
        Epoch 11/30
        369/369 ━━━━━━━━━━━━━━━━━━━━ 883s 2s/step - accuracy: 0.7811 - loss: 0.6749 - val_accuracy: 0.9403 - val_loss: 0.5588 - learning_rate: 0.0010
        Epoch 12/30
        369/369 ━━━━━━━━━━━━━━━━━━━━ 887s 2s/step - accuracy: 0.8192 - loss: 0.6289 - val_accuracy: 0.8493 - val_loss: 0.7803 - learning_rate: 0.0010
        Epoch 13/30
        369/369 ━━━━━━━━━━━━━━━━━━━━ 882s 2s/step - accuracy: 0.8185 - loss: 0.6469 - val_accuracy: 0.4362 - val_loss: 3.9177 - learning_rate: 0.0010
        Epoch 14/30
        369/369 ━━━━━━━━━━━━━━━━━━━━ 880s 2s/step - accuracy: 0.8345 - loss: 0.5965 - val_accuracy: 0.8106 - val_loss: 0.7173 - learning_rate: 0.0010
        Epoch 15/30
        369/369 ━━━━━━━━━━━━━━━━━━━━ 880s 2s/step - accuracy: 0.8120 - loss: 0.6102 - val_accuracy: 0.9294 - val_loss: 0.6104 - learning_rate: 0.0010
        Epoch 16/30
        369/369 ━━━━━━━━━━━━━━━━━━━━ 873s 2s/step - accuracy: 0.8478 - loss: 0.5914 - val_accuracy: 0.9253 - val_loss: 0.5726 - learning_rate: 0.0010
        Epoch 17/30
        369/369 ━━━━━━━━━━━━━━━━━━━━ 883s 2s/step - accuracy: 0.8649 - loss: 0.5951 - val_accuracy: 0.9437 - val_loss: 0.5328 - learning_rate: 2.0000e-04
        Epoch 18/30
        369/369 ━━━━━━━━━━━━━━━━━━━━ 887s 2s/step - accuracy: 0.8701 - loss: 0.5254 - val_accuracy: 0.9423 - val_loss: 0.5364 - learning_rate: 2.0000e-04
        Epoch 19/30
        369/369 ━━━━━━━━━━━━━━━━━━━━ 886s 2s/step - accuracy: 0.8804 - loss: 0.5457 - val_accuracy: 0.9484 - val_loss: 0.5237 - learning_rate: 2.0000e-04
        Epoch 20/30
        369/369 ━━━━━━━━━━━━━━━━━━━━ 876s 2s/step - accuracy: 0.8802 - loss: 0.5186 - val_accuracy: 0.9453 - val_loss: 0.5194 - learning_rate: 2.0000e-04
        Epoch 21/30
        369/369 ━━━━━━━━━━━━━━━━━━━━ 879s 2s/step - accuracy: 0.8789 - loss: 0.5168 - val_accuracy: 0.9413 - val_loss: 0.5235 - learning_rate: 2.0000e-04
        Epoch 22/30
        369/369 ━━━━━━━━━━━━━━━━━━━━ 877s 2s/step - accuracy: 0.8934 - loss: 0.5166 - val_accuracy: 0.9413 - val_loss: 0.5286 - learning_rate: 2.0000e-04
        Epoch 23/30
        369/369 ━━━━━━━━━━━━━━━━━━━━ 873s 2s/step - accuracy: 0.8758 - loss: 0.5149 - val_accuracy: 0.9433 - val_loss: 0.5144 - learning_rate: 2.0000e-04
        Epoch 24/30
        369/369 ━━━━━━━━━━━━━━━━━━━━ 872s 2s/step - accuracy: 0.8949 - loss: 0.4942 - val_accuracy: 0.9386 - val_loss: 0.5422 - learning_rate: 2.0000e-04
        Epoch 25/30
        369/369 ━━━━━━━━━━━━━━━━━━━━ 871s 2s/step - accuracy: 0.8928 - loss: 0.4816 - val_accuracy: 0.9124 - val_loss: 0.5750 - learning_rate: 2.0000e-04
        Epoch 26/30
        369/369 ━━━━━━━━━━━━━━━━━━━━ 871s 2s/step - accuracy: 0.8906 - loss: 0.4716 - val_accuracy: 0.9440 - val_loss: 0.5428 - learning_rate: 2.0000e-04
        Epoch 27/30
        369/369 ━━━━━━━━━━━━━━━━━━━━ 872s 2s/step - accuracy: 0.9027 - loss: 0.4822 - val_accuracy: 0.9416 - val_loss: 0.5028 - learning_rate: 2.0000e-04
        Epoch 28/30
        369/369 ━━━━━━━━━━━━━━━━━━━━ 872s 2s/step - accuracy: 0.8928 - loss: 0.5009 - val_accuracy: 0.9331 - val_loss: 0.5303 - learning_rate: 2.0000e-04
        Epoch 29/30
        369/369 ━━━━━━━━━━━━━━━━━━━━ 873s 2s/step - accuracy: 0.8861 - loss: 0.4965 - val_accuracy: 0.9338 - val_loss: 0.5306 - learning_rate: 2.0000e-04
        Epoch 30/30
        369/369 ━━━━━━━━━━━━━━━━━━━━ 872s 2s/step - accuracy: 0.9029 - loss: 0.4972 - val_accuracy: 0.9504 - val_loss: 0.5057 - learning_rate: 2.0000e-04
        Saving model...
        WARNING:absl:The `save_format` argument is deprecated in Keras 3. We recommend removing this argument as it can be inferred from the file path. Received: save_format=keras

        Training completed. Model saved to: multimodal_classifier.keras
        Saved feature scaler to: multimodal_classifier_feat_scaler.npz
        Evaluating model...
        2025-09-10 22:21:45.291828: W external/local_xla/xla/tsl/framework/cpu_allocator_impl.cc:83] Allocation of 1443540000 exceeds 10% of free system memory.
        93/93 ━━━━━━━━━━━━━━━━━━━━ 26s 276ms/step
        Test accuracy: 0.9416

    Evaluation:
        Overall accuracy: 0.8218

        Per-class accuracy:
        bias: 0.8750
        darks: 0.8208
        flats: 0.9377
        deep_sky: 0.7869
        flat_dados: 0.8246
        spectrum_dados: 0.9130
        wavelength_calibration_dados: 0.9020
        flat_baches: 0.8774
        spectrum_baches: 0.5758
        wavelength_calibration_baches: 0.9750
        einsteinturm: 1.0000

        Classification Report:
                                    precision    recall  f1-score   support

                                bias       0.88      0.88      0.88        40
                                darks       0.62      0.82      0.71       759
                                flats       0.99      0.94      0.96       674
                            deep_sky       0.95      0.79      0.86      3177
                        flat_dados       0.94      0.82      0.88        57
                    spectrum_dados       0.81      0.91      0.86        69
        wavelength_calibration_dados       0.12      0.90      0.21        51
                        flat_baches       1.00      0.88      0.93       155
                    spectrum_baches       0.50      0.58      0.54        33
        wavelength_calibration_baches       0.83      0.97      0.90        40
                        einsteinturm       0.96      1.00      0.98        81

                            accuracy                           0.82      5136
                            macro avg       0.78      0.86      0.79      5136
                        weighted avg       0.89      0.82      0.85      5136



* python main.py --loss_strategy focal_loss --epochs 30 --batch_size 32 --lr_schedule constant --initial_lr 1e-3

    Training:
        Epoch 1/30
        369/369 ━━━━━━━━━━━━━━━━━━━━ 0s 2s/step - accuracy: 0.1884 - loss: 0.23532025-09-05 13:27:56.888024: W external/local_xla/xla/tsl/framework/cp
        u_allocator_impl.cc:83] Allocation of 1443540000 exceeds 10% of free system memory.
        369/369 ━━━━━━━━━━━━━━━━━━━━ 878s 2s/step - accuracy: 0.1885 - loss: 0.2352 - val_accuracy: 0.1113 - val_loss: 0.2599 - learning_rate: 0.0010
        Epoch 2/30
        369/369 ━━━━━━━━━━━━━━━━━━━━ 877s 2s/step - accuracy: 0.3411 - loss: 0.1041 - val_accuracy: 0.2519 - val_loss: 0.1287 - learning_rate: 0.0010
        Epoch 3/30
        369/369 ━━━━━━━━━━━━━━━━━━━━ 866s 2s/step - accuracy: 0.4061 - loss: 0.0859 - val_accuracy: 0.2783 - val_loss: 0.5114 - learning_rate: 0.0010
        Epoch 4/30
        369/369 ━━━━━━━━━━━━━━━━━━━━ 867s 2s/step - accuracy: 0.4751 - loss: 0.0829 - val_accuracy: 0.3792 - val_loss: 0.0689 - learning_rate: 0.0010
        Epoch 5/30
        369/369 ━━━━━━━━━━━━━━━━━━━━ 869s 2s/step - accuracy: 0.5563 - loss: 0.0613 - val_accuracy: 0.6911 - val_loss: 0.0487 - learning_rate: 0.0010
        Epoch 6/30
        369/369 ━━━━━━━━━━━━━━━━━━━━ 869s 2s/step - accuracy: 0.6143 - loss: 0.0580 - val_accuracy: 0.6480 - val_loss: 0.0350 - learning_rate: 0.0010
        Epoch 7/30
        369/369 ━━━━━━━━━━━━━━━━━━━━ 865s 2s/step - accuracy: 0.6038 - loss: 0.0528 - val_accuracy: 0.6446 - val_loss: 0.0579 - learning_rate: 0.0010
        Epoch 8/30
        369/369 ━━━━━━━━━━━━━━━━━━━━ 871s 2s/step - accuracy: 0.6015 - loss: 0.0577 - val_accuracy: 0.7688 - val_loss: 0.0312 - learning_rate: 0.0010
        Epoch 9/30
        369/369 ━━━━━━━━━━━━━━━━━━━━ 868s 2s/step - accuracy: 0.6368 - loss: 0.0475 - val_accuracy: 0.7413 - val_loss: 0.0319 - learning_rate: 0.0010
        Epoch 10/30
        369/369 ━━━━━━━━━━━━━━━━━━━━ 868s 2s/step - accuracy: 0.6849 - loss: 0.0365 - val_accuracy: 0.6877 - val_loss: 0.0553 - learning_rate: 0.0010
        Epoch 11/30
        369/369 ━━━━━━━━━━━━━━━━━━━━ 868s 2s/step - accuracy: 0.6948 - loss: 0.0399 - val_accuracy: 0.7284 - val_loss: 0.0601 - learning_rate: 0.0010
        Epoch 12/30
        369/369 ━━━━━━━━━━━━━━━━━━━━ 866s 2s/step - accuracy: 0.7143 - loss: 0.0384 - val_accuracy: 0.6500 - val_loss: 0.0620 - learning_rate: 0.0010
        Epoch 13/30
        369/369 ━━━━━━━━━━━━━━━━━━━━ 867s 2s/step - accuracy: 0.7007 - loss: 0.0388 - val_accuracy: 0.8272 - val_loss: 0.0257 - learning_rate: 0.0010
        Epoch 14/30
        369/369 ━━━━━━━━━━━━━━━━━━━━ 867s 2s/step - accuracy: 0.7119 - loss: 0.0387 - val_accuracy: 0.7261 - val_loss: 0.0246 - learning_rate: 0.0010
        Epoch 15/30
        369/369 ━━━━━━━━━━━━━━━━━━━━ 867s 2s/step - accuracy: 0.7031 - loss: 0.0341 - val_accuracy: 0.8198 - val_loss: 0.0257 - learning_rate: 0.0010
        Epoch 16/30
        369/369 ━━━━━━━━━━━━━━━━━━━━ 865s 2s/step - accuracy: 0.7239 - loss: 0.0418 - val_accuracy: 0.9121 - val_loss: 0.0258 - learning_rate: 0.0010
        Epoch 17/30
        369/369 ━━━━━━━━━━━━━━━━━━━━ 867s 2s/step - accuracy: 0.7521 - loss: 0.0303 - val_accuracy: 0.8866 - val_loss: 0.0213 - learning_rate: 0.0010
        Epoch 18/30
        369/369 ━━━━━━━━━━━━━━━━━━━━ 866s 2s/step - accuracy: 0.7643 - loss: 0.0334 - val_accuracy: 0.8870 - val_loss: 0.0208 - learning_rate: 0.0010
        Epoch 19/30
        369/369 ━━━━━━━━━━━━━━━━━━━━ 869s 2s/step - accuracy: 0.7691 - loss: 0.0262 - val_accuracy: 0.7977 - val_loss: 0.0386 - learning_rate: 0.0010
        Epoch 20/30
        369/369 ━━━━━━━━━━━━━━━━━━━━ 867s 2s/step - accuracy: 0.7857 - loss: 0.0317 - val_accuracy: 0.7838 - val_loss: 0.0357 - learning_rate: 0.0010
        Epoch 21/30
        369/369 ━━━━━━━━━━━━━━━━━━━━ 866s 2s/step - accuracy: 0.7587 - loss: 0.0360 - val_accuracy: 0.8259 - val_loss: 0.0383 - learning_rate: 0.0010
        Epoch 22/30
        369/369 ━━━━━━━━━━━━━━━━━━━━ 865s 2s/step - accuracy: 0.7626 - loss: 0.0262 - val_accuracy: 0.8798 - val_loss: 0.0206 - learning_rate: 0.0010
        Epoch 23/30
        369/369 ━━━━━━━━━━━━━━━━━━━━ 866s 2s/step - accuracy: 0.7535 - loss: 0.0243 - val_accuracy: 0.9168 - val_loss: 0.0165 - learning_rate: 0.0010
        Epoch 24/30
        369/369 ━━━━━━━━━━━━━━━━━━━━ 866s 2s/step - accuracy: 0.7753 - loss: 0.0267 - val_accuracy: 0.8741 - val_loss: 0.0195 - learning_rate: 0.0010
        Epoch 25/30
        369/369 ━━━━━━━━━━━━━━━━━━━━ 868s 2s/step - accuracy: 0.7649 - loss: 0.0268 - val_accuracy: 0.9413 - val_loss: 0.0152 - learning_rate: 0.0010
        Epoch 26/30
        369/369 ━━━━━━━━━━━━━━━━━━━━ 868s 2s/step - accuracy: 0.7842 - loss: 0.0249 - val_accuracy: 0.9165 - val_loss: 0.0182 - learning_rate: 0.0010
        Epoch 27/30
        369/369 ━━━━━━━━━━━━━━━━━━━━ 868s 2s/step - accuracy: 0.7895 - loss: 0.0253 - val_accuracy: 0.9250 - val_loss: 0.0153 - learning_rate: 0.0010
        Epoch 28/30
        369/369 ━━━━━━━━━━━━━━━━━━━━ 867s 2s/step - accuracy: 0.8024 - loss: 0.0220 - val_accuracy: 0.8181 - val_loss: 0.0161 - learning_rate: 0.0010
        Epoch 29/30
        369/369 ━━━━━━━━━━━━━━━━━━━━ 867s 2s/step - accuracy: 0.7678 - loss: 0.0249 - val_accuracy: 0.8408 - val_loss: 0.0306 - learning_rate: 0.0010
        Epoch 30/30
        369/369 ━━━━━━━━━━━━━━━━━━━━ 874s 2s/step - accuracy: 0.7809 - loss: 0.0208 - val_accuracy: 0.9206 - val_loss: 0.0217 - learning_rate: 0.0010
        Saving model...
        WARNING:absl:The `save_format` argument is deprecated in Keras 3. We recommend removing this argument as it can be inferred from the file path
        . Received: save_format=keras

        Training completed. Model saved to: multimodal_classifier.keras
        Saved feature scaler to: multimodal_classifier_feat_scaler.npz
        Evaluating model...
        2025-09-05 20:27:50.784474: W external/local_xla/xla/tsl/framework/cpu_allocator_impl.cc:83] Allocation of 1443540000 exceeds 10% of free syst
        em memory.
        93/93 ━━━━━━━━━━━━━━━━━━━━ 26s 275ms/step
        Test accuracy: 0.9413


    Evaluation:

        Overall accuracy: 0.8154

        Per-class accuracy:
        bias: 0.9000
        darks: 0.7971
        flats: 0.9288
        deep_sky: 0.7812
        flat_dados: 0.9298
        spectrum_dados: 0.6957
        wavelength_calibration_dados: 0.9020
        flat_baches: 0.9613
        spectrum_baches: 0.6667
        wavelength_calibration_baches: 1.0000
        einsteinturm: 1.0000

        Classification Report:
                                    precision    recall  f1-score   support

                                bias       0.86      0.90      0.88        40
                                darks       0.63      0.80      0.71       759
                                flats       0.98      0.93      0.95       674
                            deep_sky       0.93      0.78      0.85      3177
                        flat_dados       0.98      0.93      0.95        57
                    spectrum_dados       0.80      0.70      0.74        69
        wavelength_calibration_dados       0.11      0.90      0.19        51
                        flat_baches       1.00      0.96      0.98       155
                    spectrum_baches       0.76      0.67      0.71        33
        wavelength_calibration_baches       0.95      1.00      0.98        40
                        einsteinturm       1.00      1.00      1.00        81

                            accuracy                           0.82      5136
                            macro avg       0.82      0.87      0.81      5136
                        weighted avg       0.89      0.82      0.84      5136



* python main.py --loss_strategy class_weights --epochs 30 --batch_size 32 --lr_schedule constant --initial_lr 1e-3

    Training:
        Processing completed. Successfully processed 14730 of 14730 files.
        Initializing model...
        Training model...
        2025-09-09 12:27:50.152913: W external/local_xla/xla/tsl/framework/cpu_allocator_impl.cc:83] Allocation of 5774160000 exceeds 10% of free syst
        em memory.
        Epoch 1/30
        369/369 ━━━━━━━━━━━━━━━━━━━━ 0s 2s/step - accuracy: 0.2145 - loss: 2.15082025-09-09 12:42:30.298732: W external/local_xla/xla/tsl/framework/cp
        u_allocator_impl.cc:83] Allocation of 1443540000 exceeds 10% of free system memory.
        369/369 ━━━━━━━━━━━━━━━━━━━━ 897s 2s/step - accuracy: 0.2145 - loss: 2.1498 - val_accuracy: 0.1147 - val_loss: 2.3755 - learning_rate: 0.0010
        Epoch 2/30
        369/369 ━━━━━━━━━━━━━━━━━━━━ 891s 2s/step - accuracy: 0.2896 - loss: 1.3836 - val_accuracy: 0.4172 - val_loss: 1.4851 - learning_rate: 0.0010
        Epoch 3/30
        369/369 ━━━━━━━━━━━━━━━━━━━━ 889s 2s/step - accuracy: 0.4170 - loss: 1.1319 - val_accuracy: 0.4871 - val_loss: 1.3192 - learning_rate: 0.0010
        Epoch 4/30
        369/369 ━━━━━━━━━━━━━━━━━━━━ 884s 2s/step - accuracy: 0.5134 - loss: 1.0414 - val_accuracy: 0.6772 - val_loss: 1.1885 - learning_rate: 0.0010
        Epoch 5/30
        369/369 ━━━━━━━━━━━━━━━━━━━━ 878s 2s/step - accuracy: 0.5241 - loss: 0.9472 - val_accuracy: 0.7926 - val_loss: 0.9235 - learning_rate: 0.0010
        Epoch 6/30
        369/369 ━━━━━━━━━━━━━━━━━━━━ 876s 2s/step - accuracy: 0.5873 - loss: 0.8983 - val_accuracy: 0.6772 - val_loss: 1.1162 - learning_rate: 0.0010
        Epoch 7/30
        369/369 ━━━━━━━━━━━━━━━━━━━━ 882s 2s/step - accuracy: 0.5859 - loss: 0.8512 - val_accuracy: 0.7614 - val_loss: 0.9293 - learning_rate: 0.0010
        Epoch 8/30
        369/369 ━━━━━━━━━━━━━━━━━━━━ 886s 2s/step - accuracy: 0.6381 - loss: 0.8433 - val_accuracy: 0.7916 - val_loss: 0.8072 - learning_rate: 0.0010
        Epoch 9/30
        369/369 ━━━━━━━━━━━━━━━━━━━━ 882s 2s/step - accuracy: 0.6914 - loss: 0.7625 - val_accuracy: 0.8313 - val_loss: 0.7873 - learning_rate: 0.0010
        Epoch 10/30
        369/369 ━━━━━━━━━━━━━━━━━━━━ 881s 2s/step - accuracy: 0.7295 - loss: 0.6803 - val_accuracy: 0.8741 - val_loss: 0.7126 - learning_rate: 0.0010
        Epoch 11/30
        369/369 ━━━━━━━━━━━━━━━━━━━━ 885s 2s/step - accuracy: 0.7348 - loss: 0.6798 - val_accuracy: 0.8035 - val_loss: 0.7800 - learning_rate: 0.0010
        Epoch 12/30
        369/369 ━━━━━━━━━━━━━━━━━━━━ 886s 2s/step - accuracy: 0.7641 - loss: 0.7104 - val_accuracy: 0.5883 - val_loss: 1.3008 - learning_rate: 0.0010
        Epoch 13/30
        369/369 ━━━━━━━━━━━━━━━━━━━━ 886s 2s/step - accuracy: 0.8010 - loss: 0.6215 - val_accuracy: 0.8676 - val_loss: 0.6904 - learning_rate: 0.0010
        Epoch 14/30
        369/369 ━━━━━━━━━━━━━━━━━━━━ 876s 2s/step - accuracy: 0.8014 - loss: 0.6148 - val_accuracy: 0.9202 - val_loss: 0.6745 - learning_rate: 0.0010
        Epoch 15/30
        369/369 ━━━━━━━━━━━━━━━━━━━━ 883s 2s/step - accuracy: 0.8228 - loss: 0.6159 - val_accuracy: 0.9124 - val_loss: 0.6244 - learning_rate: 0.0010
        Epoch 16/30
        369/369 ━━━━━━━━━━━━━━━━━━━━ 885s 2s/step - accuracy: 0.8337 - loss: 0.6152 - val_accuracy: 0.9155 - val_loss: 0.7020 - learning_rate: 0.0010
        Epoch 17/30
        369/369 ━━━━━━━━━━━━━━━━━━━━ 878s 2s/step - accuracy: 0.8296 - loss: 0.5809 - val_accuracy: 0.7203 - val_loss: 1.0169 - learning_rate: 0.0010
        Epoch 18/30
        369/369 ━━━━━━━━━━━━━━━━━━━━ 887s 2s/step - accuracy: 0.8458 - loss: 0.6079 - val_accuracy: 0.9199 - val_loss: 0.5912 - learning_rate: 0.0010
        Epoch 19/30
        369/369 ━━━━━━━━━━━━━━━━━━━━ 888s 2s/step - accuracy: 0.8599 - loss: 0.5859 - val_accuracy: 0.9426 - val_loss: 0.5529 - learning_rate: 0.0010
        Epoch 20/30
        369/369 ━━━━━━━━━━━━━━━━━━━━ 879s 2s/step - accuracy: 0.8564 - loss: 0.5848 - val_accuracy: 0.9355 - val_loss: 0.5854 - learning_rate: 0.0010
        Epoch 21/30
        369/369 ━━━━━━━━━━━━━━━━━━━━ 881s 2s/step - accuracy: 0.8494 - loss: 0.5856 - val_accuracy: 0.9447 - val_loss: 0.5350 - learning_rate: 0.0010
        Epoch 22/30
        369/369 ━━━━━━━━━━━━━━━━━━━━ 882s 2s/step - accuracy: 0.8527 - loss: 0.5475 - val_accuracy: 0.9196 - val_loss: 0.5552 - learning_rate: 0.0010
        Epoch 23/30
        369/369 ━━━━━━━━━━━━━━━━━━━━ 886s 2s/step - accuracy: 0.8748 - loss: 0.5498 - val_accuracy: 0.9477 - val_loss: 0.5201 - learning_rate: 0.0010
        Epoch 24/30
        369/369 ━━━━━━━━━━━━━━━━━━━━ 887s 2s/step - accuracy: 0.8505 - loss: 0.5584 - val_accuracy: 0.4936 - val_loss: 1.7202 - learning_rate: 0.0010
        Epoch 25/30
        369/369 ━━━━━━━━━━━━━━━━━━━━ 877s 2s/step - accuracy: 0.8725 - loss: 0.5672 - val_accuracy: 0.9457 - val_loss: 0.5150 - learning_rate: 0.0010
        Epoch 26/30
        369/369 ━━━━━━━━━━━━━━━━━━━━ 879s 2s/step - accuracy: 0.8789 - loss: 0.5778 - val_accuracy: 0.9487 - val_loss: 0.5045 - learning_rate: 0.0010
        Epoch 27/30
        369/369 ━━━━━━━━━━━━━━━━━━━━ 875s 2s/step - accuracy: 0.8885 - loss: 0.5076 - val_accuracy: 0.9314 - val_loss: 0.5568 - learning_rate: 0.0010
        Epoch 28/30
        369/369 ━━━━━━━━━━━━━━━━━━━━ 881s 2s/step - accuracy: 0.8796 - loss: 0.5115 - val_accuracy: 0.9494 - val_loss: 0.4951 - learning_rate: 0.0010
        Epoch 29/30
        369/369 ━━━━━━━━━━━━━━━━━━━━ 888s 2s/step - accuracy: 0.9012 - loss: 0.4771 - val_accuracy: 0.9443 - val_loss: 0.5180 - learning_rate: 0.0010
        Epoch 30/30
        369/369 ━━━━━━━━━━━━━━━━━━━━ 885s 2s/step - accuracy: 0.8720 - loss: 0.5113 - val_accuracy: 0.9447 - val_loss: 0.5007 - learning_rate: 0.0010
        Saving model...
        WARNING:absl:The `save_format` argument is deprecated in Keras 3. We recommend removing this argument as it can be inferred from the file path
        . Received: save_format=keras

        Training completed. Model saved to: multimodal_classifier.keras
        Saved feature scaler to: multimodal_classifier_feat_scaler.npz
        Evaluating model...
        2025-09-09 19:49:39.687886: W external/local_xla/xla/tsl/framework/cpu_allocator_impl.cc:83] Allocation of 1443540000 exceeds 10% of free syst
        em memory.
        93/93 ━━━━━━━━━━━━━━━━━━━━ 26s 276ms/step
        Test accuracy: 0.9494

    Evaluation:
        Overall accuracy: 0.8505

        Per-class accuracy:
        bias: 0.8750
        darks: 0.8366
        flats: 0.9332
        deep_sky: 0.8250
        flat_dados: 0.9649
        spectrum_dados: 0.9275
        wavelength_calibration_dados: 1.0000
        flat_baches: 0.8903
        spectrum_baches: 0.5758
        wavelength_calibration_baches: 1.0000
        einsteinturm: 1.0000

        Classification Report:
                                    precision    recall  f1-score   support

                                bias       1.00      0.88      0.93        40
                                darks       0.56      0.84      0.67       759
                                flats       1.00      0.93      0.96       674
                            deep_sky       0.95      0.82      0.88      3177
                        flat_dados       0.98      0.96      0.97        57
                    spectrum_dados       0.81      0.93      0.86        69
        wavelength_calibration_dados       0.33      1.00      0.50        51
                        flat_baches       1.00      0.89      0.94       155
                    spectrum_baches       0.53      0.58      0.55        33
        wavelength_calibration_baches       1.00      1.00      1.00        40
                        einsteinturm       1.00      1.00      1.00        81

                            accuracy                           0.85      5136
                            macro avg       0.83      0.89      0.84      5136
                        weighted avg       0.89      0.85      0.86      5136



    Updated evaluation: python evaluate_model.py   --model_path multimodal_classifier_class_weights.keras   --data_dir ../image_classification_test_sample   --thresholds 0.904,0.951,0.759,0.04,0.297,0.938,0.95,0.038,0.77,0.775,0.973   --abstain_unknown   --pr_out_dir pr_curves_with_unknown   --save_thresholds thresholds_with_unknown.json

        Overall accuracy (argmax): 0.8505
        Overall coverage: 0.9840
        Accuracy@coverage: 0.9533
        Overall accuracy (unknown counted incorrect): 0.9381

        Per-class accuracy:
        bias: 0.8750
        darks: 0.7260
        flats: 0.9318
        deep_sky: 0.9940
        flat_dados: 0.9474
        spectrum_dados: 0.8406
        wavelength_calibration_dados: 0.9216
        flat_baches: 0.9677
        spectrum_baches: 0.5152
        wavelength_calibration_baches: 0.9750
        einsteinturm: 1.0000
        unknown (abstained): reported separately via coverage/accuracy@coverage

        Classification Report:
                                    precision    recall  f1-score   support

                                bias       1.00      0.92      0.96        38
                                darks       1.00      0.73      0.84       754
                                flats       1.00      0.99      1.00       633
                            deep_sky       0.93      1.00      0.96      3159
                        flat_dados       0.98      0.95      0.96        57
                    spectrum_dados       1.00      0.88      0.94        66
        wavelength_calibration_dados       1.00      0.98      0.99        48
                        flat_baches       1.00      0.99      1.00       151
                    spectrum_baches       0.94      0.61      0.74        28
        wavelength_calibration_baches       1.00      1.00      1.00        39
                        einsteinturm       1.00      1.00      1.00        81

                            accuracy                           0.95      5054
                            macro avg       0.99      0.91      0.94      5054
                        weighted avg       0.96      0.95      0.95      5054


        Detailed Confusion Matrix Analysis:

        bias:
        True Positives: 35
        False Positives: 0
        False Negatives: 5
        True Negatives: 5096
        Most confused with:
            - Predicted as deep_sky: 3 times
            - Predicted as unknown: 2 times

        darks:
        True Positives: 551
        False Positives: 0
        False Negatives: 208
        True Negatives: 4377
        Most confused with:
            - Predicted as deep_sky: 203 times
            - Predicted as unknown: 5 times


        flats:
        True Positives: 628
        False Positives: 0
        False Negatives: 46
        True Negatives: 4462
        Most confused with:
            - Predicted as deep_sky: 5 times
            - Predicted as unknown: 41 times

        deep_sky:
        True Positives: 3158
        False Positives: 234
        False Negatives: 19
        True Negatives: 1725
        Most confused with:
            - Misclassified as deep_sky: 3 times
            - Misclassified as deep_sky: 203 times
            - Misclassified as deep_sky: 5 times
            - Predicted as flat_dados: 1 times
            - Misclassified as deep_sky: 3 times
            - Misclassified as deep_sky: 8 times
            - Misclassified as deep_sky: 1 times
            - Misclassified as deep_sky: 11 times
            - Predicted as unknown: 18 times

        flat_dados:
        True Positives: 54
        False Positives: 1
        False Negatives: 3
        True Negatives: 5078
        Most confused with:
            - Predicted as deep_sky: 3 times
            - Misclassified as flat_dados: 1 times

        spectrum_dados:
        True Positives: 58
        False Positives: 0
        False Negatives: 11
        True Negatives: 5067
        Most confused with:
            - Predicted as deep_sky: 8 times
            - Predicted as unknown: 3 times

        wavelength_calibration_dados:
        True Positives: 47
        False Positives: 0
        False Negatives: 4
        True Negatives: 5085
        Most confused with:
            - Predicted as deep_sky: 1 times
            - Predicted as unknown: 3 times

        flat_baches:
        True Positives: 150
        False Positives: 0
        False Negatives: 5
        True Negatives: 4981
        Most confused with:
            - Predicted as spectrum_baches: 1 times
            - Predicted as unknown: 4 times

        spectrum_baches:
        True Positives: 17
        False Positives: 1
        False Negatives: 16
        True Negatives: 5102
        Most confused with:
            - Predicted as deep_sky: 11 times
            - Misclassified as spectrum_baches: 1 times
            - Predicted as unknown: 5 times

        wavelength_calibration_baches:
        True Positives: 39
        False Positives: 0
        False Negatives: 1
        True Negatives: 5096
        Most confused with:
            - Predicted as unknown: 1 times

        einsteinturm:
        True Positives: 81
        False Positives: 0
        False Negatives: 0
        True Negatives: 5055

        unknown:
        True Positives: 0
        False Positives: 82
        False Negatives: 0
        True Negatives: 5054
        Most confused with:
            - Misclassified as unknown: 2 times
            - Misclassified as unknown: 5 times
            - Misclassified as unknown: 41 times
            - Misclassified as unknown: 18 times
            - Misclassified as unknown: 3 times
            - Misclassified as unknown: 3 times
            - Misclassified as unknown: 4 times
            - Misclassified as unknown: 5 times
            - Misclassified as unknown: 1 times

        Analyzing feature importance...

        Top 10 Most Important Features:
            Feature  Importance
        14  feature_14   32.177353
        17  feature_17   26.331863
        6    feature_6   26.221165
        16  feature_16   24.516695
        13  feature_13   22.324358
        4    feature_4    5.270573
        19  feature_19    4.814322
        15  feature_15    3.860364
        1    feature_1    3.761590
        3    feature_3    3.177174





----------------------------------------------------------------------------------------------------
New larger memory restrictions:
* python main.py --data_dir ../image_classification_training_sample --epochs 30 --batch_size 24 --target_w 448 --target_h 448 --loss_strategy class_weights --label_smoothing 0.08 --initial_lr 1e-3 --batch_ref 32 --lr_schedule constant --cw_beta 0.3 --cw_cap 4.0 --model_out multimodal_classifier_class_weights_more_memmory.keras


* python evaluate_model.py   --model_path multimodal_classifier_class_weights_more_memmory.keras   --data_dir ../image_classification_test_sample   --target_w 448 --target_h 448

    Overall accuracy (argmax): 0.9297

    Per-class accuracy:
    bias: 0.8750
    darks: 0.8696
    flats: 0.9407
    deep_sky: 0.9452
    flat_dados: 0.8070
    spectrum_dados: 0.9420
    wavelength_calibration_dados: 0.8824
    flat_baches: 0.9613
    spectrum_baches: 0.5455
    wavelength_calibration_baches: 0.9750
    einsteinturm: 1.0000

    Classification Report:
                                precision    recall  f1-score   support

                            bias       1.00      0.88      0.93        40
                            darks       0.89      0.87      0.88       759
                            flats       0.99      0.94      0.96       674
                        deep_sky       0.96      0.95      0.95      3177
                    flat_dados       1.00      0.81      0.89        57
                spectrum_dados       0.31      0.94      0.47        69
    wavelength_calibration_dados       0.98      0.88      0.93        51
                    flat_baches       0.99      0.96      0.98       155
                spectrum_baches       0.75      0.55      0.63        33
    wavelength_calibration_baches       1.00      0.97      0.99        40
                    einsteinturm       1.00      1.00      1.00        81

                        accuracy                           0.93      5136
                        macro avg       0.90      0.89      0.87      5136
                    weighted avg       0.95      0.93      0.94      5136


    Detailed Confusion Matrix Analysis:

    bias:
    True Positives: 35
    False Positives: 0
    False Negatives: 5
    True Negatives: 5096
    Most confused with:
        - Predicted as darks: 2 times
        - Predicted as deep_sky: 3 times

    darks:
    True Positives: 660
    False Positives: 83
    False Negatives: 99
    True Negatives: 4294
    Most confused with:
        - Misclassified as darks: 2 times
        - Predicted as flats: 2 times
        - Misclassified as darks: 40 times
        - Predicted as deep_sky: 97 times
        - Misclassified as darks: 41 times

    flats:
    True Positives: 634
    False Positives: 7
    False Negatives: 40
    True Negatives: 4455
    Most confused with:
        - Predicted as darks: 40 times
        - Misclassified as flats: 2 times
        - Misclassified as flats: 3 times
        - Misclassified as flats: 2 times

    deep_sky:
    True Positives: 3003
    False Positives: 118
    False Negatives: 174
    True Negatives: 1841
    Most confused with:
        - Misclassified as deep_sky: 3 times
        - Predicted as darks: 41 times
        - Misclassified as deep_sky: 97 times
        - Predicted as flats: 3 times
        - Misclassified as deep_sky: 2 times
        - Predicted as spectrum_dados: 130 times
        - Misclassified as deep_sky: 4 times
        - Misclassified as deep_sky: 6 times
        - Misclassified as deep_sky: 6 times

    flat_dados:
    True Positives: 46
    False Positives: 0
    False Negatives: 11
    True Negatives: 5079
    Most confused with:
        - Predicted as flats: 2 times
        - Predicted as deep_sky: 2 times
        - Predicted as spectrum_dados: 7 times

    spectrum_baches:
    True Positives: 18
    False Positives: 6
    False Negatives: 15
    True Negatives: 5097
    Most confused with:
        - Predicted as deep_sky: 6 times
        - Predicted as spectrum_dados: 8 times
        - Predicted as flat_baches: 1 times
        - Misclassified as spectrum_baches: 6 times

    wavelength_calibration_baches:
    True Positives: 39
    False Positives: 0
    False Negatives: 1
    True Negatives: 5096
    Most confused with:
        - Predicted as wavelength_calibration_dados: 1 times

    einsteinturm:
    True Positives: 81
    False Positives: 0
    False Negatives: 0
    True Negatives: 5055

    Analyzing feature importance...

    Top 10 Most Important Features:
        Feature  Importance
    6    feature_6   25.594021
    14  feature_14   25.199764
    17  feature_17   23.514898
    16  feature_16   17.052120
    13  feature_13   13.550873
    3    feature_3    3.634350
    20  feature_20    2.669310
    4    feature_4    2.658340
    15  feature_15    2.643308
    12  feature_12    2.436071


* python evaluate_model.py   --model_path multimodal_classifier_class_weights_more_memmory.keras   --data_dir ../image_classification_test_sample   --target_w 448 --target_h 448 --auto_threshold max_f1  --pr_out_dir pr_curves --save_thresholds thresholds_suggested.json

    Overall accuracy (argmax): 0.9297
    Overall accuracy (thresholded): 0.9609

    Per-class accuracy:
    bias: 0.8750
    darks: 0.8630
    flats: 0.9407
    deep_sky: 0.9969
    flat_dados: 0.8596
    spectrum_dados: 0.8986
    wavelength_calibration_dados: 0.8824
    flat_baches: 0.9613
    spectrum_baches: 0.5758
    wavelength_calibration_baches: 0.9750
    einsteinturm: 1.0000

    Classification Report:
                                precision    recall  f1-score   support

                            bias       1.00      0.88      0.93        40
                            darks       0.93      0.86      0.89       759
                            flats       1.00      0.94      0.97       674
                        deep_sky       0.96      1.00      0.98      3177
                    flat_dados       1.00      0.86      0.92        57
                spectrum_dados       0.90      0.90      0.90        69
    wavelength_calibration_dados       0.98      0.88      0.93        51
                    flat_baches       1.00      0.96      0.98       155
                spectrum_baches       0.76      0.58      0.66        33
    wavelength_calibration_baches       1.00      0.97      0.99        40
                    einsteinturm       1.00      1.00      1.00        81

                        accuracy                           0.96      5136
                        macro avg       0.96      0.89      0.92      5136
                    weighted avg       0.96      0.96      0.96      5136


    Detailed Confusion Matrix Analysis:

    bias:
    True Positives: 35
    False Positives: 0
    False Negatives: 5
    True Negatives: 5096
    Most confused with:
        - Predicted as darks: 2 times
        - Predicted as deep_sky: 3 times

    darks:
    True Positives: 655
    False Positives: 50
    False Negatives: 104
    True Negatives: 4327
    Most confused with:
        - Misclassified as darks: 2 times
        - Predicted as flats: 2 times
        - Misclassified as darks: 40 times
        - Predicted as deep_sky: 102 times
        - Misclassified as darks: 8 times

    flats:
    True Positives: 634
    False Positives: 3
    False Negatives: 40
    True Negatives: 4459
    Most confused with:
        - Predicted as darks: 40 times
        - Misclassified as flats: 2 times
        - Misclassified as flats: 1 times

    deep_sky:
    True Positives: 3167
    False Positives: 134
    False Negatives: 10
    True Negatives: 1825
    Most confused with:
        - Misclassified as deep_sky: 3 times
        - Predicted as darks: 8 times
        - Misclassified as deep_sky: 102 times
        - Predicted as flats: 1 times
        - Misclassified as deep_sky: 4 times
        - Predicted as spectrum_dados: 1 times
        - Misclassified as deep_sky: 7 times
        - Misclassified as deep_sky: 6 times
        - Misclassified as deep_sky: 12 times

    flat_dados:
    True Positives: 49
    False Positives: 0
    False Negatives: 8
    True Negatives: 5079
    Most confused with:
        - Predicted as deep_sky: 4 times
        - Predicted as spectrum_dados: 4 times

    spectrum_dados:
    True Positives: 62
    False Positives: 7
    False Negatives: 7
    True Negatives: 5060
    Most confused with:
        - Predicted as deep_sky: 7 times
        - Misclassified as spectrum_dados: 1 times
        - Misclassified as spectrum_dados: 4 times
        - Misclassified as spectrum_dados: 2 times

        wavelength_calibration_dados:
    True Positives: 45
    False Positives: 1
    False Negatives: 6
    True Negatives: 5084
    Most confused with:
        - Predicted as deep_sky: 6 times
        - Misclassified as wavelength_calibration_dados: 1 times

    flat_baches:
    True Positives: 149
    False Positives: 0
    False Negatives: 6
    True Negatives: 4981
    Most confused with:
        - Predicted as spectrum_baches: 6 times

    spectrum_baches:
    True Positives: 19
    False Positives: 6
    False Negatives: 14
    True Negatives: 5097
    Most confused with:
        - Predicted as deep_sky: 12 times
        - Predicted as spectrum_dados: 2 times
        - Misclassified as spectrum_baches: 6 times

    wavelength_calibration_baches:
    True Positives: 39
    False Positives: 0
    False Negatives: 1
    True Negatives: 5096
    Most confused with:
        - Predicted as wavelength_calibration_dados: 1 times

    einsteinturm:
    True Positives: 81
    False Positives: 0
    False Negatives: 0
    True Negatives: 5055

    Analyzing feature importance...

    Top 10 Most Important Features:
        Feature  Importance
    6    feature_6   25.594021
    14  feature_14   25.199764
    17  feature_17   23.514898
    16  feature_16   17.052120
    13  feature_13   13.550873
    3    feature_3    3.634350
    20  feature_20    2.669310
    4    feature_4    2.658340
    15  feature_15    2.643308
    12  feature_12    2.436071


* python main.py   --data_dir ../image_classification_training_sample   --target_w 448 --target_h 448 --batch_size 24 --epochs 30   --loss_strategy class_weights --cw_beta 0.3 --cw_cap 4.0   --label_smoothing 0.08 --initial_lr 1e-3 --batch_ref 32 --lr_schedule constant   --augment --aug_strength 0.3   --aug_conservative 'darks,flats,spectrum_dados,wavelength_calibration_dados,wavelength_calibration_baches'   --model_out multimodal_classifier_class_weights_aug2.keras


* python evaluate_model.py --model_path multimodal_classifier_class_weights_aug2.keras   --data_dir ../image_classification_test_sample   --target_w 448 --target_h 448   --auto_threshold max_f1 --tta   --pr_out_dir pr_curves_aug2 --save_thresholds thresholds_suggested_aug2.json


    Overall accuracy (argmax): 0.9276
    Overall accuracy (thresholded): 0.9303

    Per-class accuracy:
    bias: 0.8750
    darks: 0.8445
    flats: 0.9332
    deep_sky: 0.9522
    flat_dados: 0.8421
    spectrum_dados: 0.9710
    wavelength_calibration_dados: 0.8627
    flat_baches: 0.9613
    spectrum_baches: 0.5758
    wavelength_calibration_baches: 1.0000
    einsteinturm: 1.0000

    Classification Report:
                                precision    recall  f1-score   support

                            bias       0.92      0.88      0.90        40
                            darks       0.78      0.84      0.81       759
                            flats       1.00      0.93      0.97       674
                        deep_sky       0.95      0.95      0.95      3177
                    flat_dados       0.98      0.84      0.91        57
                spectrum_dados       0.97      0.97      0.97        69
    wavelength_calibration_dados       1.00      0.86      0.93        51
                    flat_baches       1.00      0.96      0.98       155
                spectrum_baches       0.73      0.58      0.64        33
    wavelength_calibration_baches       1.00      1.00      1.00        40
                    einsteinturm       0.93      1.00      0.96        81

                        accuracy                           0.93      5136
                        macro avg       0.93      0.89      0.91      5136
                    weighted avg       0.93      0.93      0.93      5136


    Detailed Confusion Matrix Analysis:

    bias:
    True Positives: 35
    False Positives: 3
    False Negatives: 5
    True Negatives: 5093
    Most confused with:
        - Predicted as darks: 2 times
        - Predicted as deep_sky: 3 times
        - Misclassified as bias: 3 times

    darks:
    True Positives: 641
    False Positives: 183
    False Negatives: 118
    True Negatives: 4194
    Most confused with:
        - Misclassified as darks: 2 times
        - Misclassified as darks: 40 times
        - Predicted as deep_sky: 118 times
        - Misclassified as darks: 141 times

    flats:
    True Positives: 629
    False Positives: 0
    False Negatives: 45
    True Negatives: 4462
    Most confused with:
        - Predicted as darks: 40 times
        - Predicted as deep_sky: 5 times
        deep_sky:
    True Positives: 3025
    False Positives: 156
    False Negatives: 152
    True Negatives: 1803
    Most confused with:
        - Predicted as bias: 3 times
        - Misclassified as deep_sky: 3 times
        - Predicted as darks: 141 times
        - Misclassified as deep_sky: 118 times
        - Misclassified as deep_sky: 5 times
        - Predicted as flat_dados: 1 times
        - Misclassified as deep_sky: 9 times
        - Misclassified as deep_sky: 2 times
        - Misclassified as deep_sky: 7 times
        - Predicted as spectrum_baches: 1 times
        - Misclassified as deep_sky: 12 times
        - Predicted as einsteinturm: 6 times

    flat_dados:
    True Positives: 48
    False Positives: 1
    False Negatives: 9
    True Negatives: 5078
    Most confused with:
        - Predicted as deep_sky: 9 times
        - Misclassified as flat_dados: 1 times

    spectrum_dados:
    True Positives: 67
    False Positives: 2
    False Negatives: 2
    True Negatives: 5065
    Most confused with:
        - Predicted as deep_sky: 2 times
        - Misclassified as spectrum_dados: 2 times

    wavelength_calibration_dados:
    True Positives: 44
    False Positives: 0
    False Negatives: 7
    True Negatives: 5085
    Most confused with:
        - Predicted as deep_sky: 7 times

    flat_baches:
    True Positives: 149
    False Positives: 0
    False Negatives: 6
    True Negatives: 4981
    Most confused with:
        - Predicted as spectrum_baches: 6 times

    spectrum_baches:
    True Positives: 19
    False Positives: 7
    False Negatives: 14
    True Negatives: 5096
    Most confused with:
        - Predicted as deep_sky: 12 times
        - Misclassified as spectrum_baches: 1 times
        - Predicted as spectrum_dados: 2 times
        - Misclassified as spectrum_baches: 6 times

    wavelength_calibration_baches:
    True Positives: 40
    False Positives: 0
    False Negatives: 0
    True Negatives: 5096

    einsteinturm:
    True Positives: 81
    False Positives: 6
    False Negatives: 0
    True Negatives: 5049
    Most confused with:
        - Misclassified as einsteinturm: 6 times

    Analyzing feature importance...

    Top 10 Most Important Features:
        Feature  Importance
    13  feature_13   42.613064
    16  feature_16   41.667313
    17  feature_17   31.545372
    14  feature_14   27.080835
    6    feature_6   17.203369
    3    feature_3    4.079737
    19  feature_19    3.638450
    4    feature_4    3.284776
    15  feature_15    2.922575
    1    feature_1    2.537063

* python evaluate_model.py   --model_path multimodal_classifier_class_weights_balanced.keras   --data_dir ../image_classification_test_sample   --target_w 448 --target_h 448   --tta --fit_temperature   --auto_threshold max_f1   --pr_out_dir pr_curves_balanced   --save_thresholds thresholds_balanced.json

    Overall accuracy (argmax): 0.8509
    Overall accuracy (thresholded): 0.9400

    Per-class accuracy:
    bias: 0.8750
    darks: 0.8485
    flats: 0.9407
    deep_sky: 0.9647
    flat_dados: 0.8947
    spectrum_dados: 0.9420
    wavelength_calibration_dados: 0.8627
    flat_baches: 0.9613
    spectrum_baches: 0.6061
    wavelength_calibration_baches: 1.0000
    einsteinturm: 1.0000

    Classification Report:
                                precision    recall  f1-score   support

                            bias       1.00      0.88      0.93        40
                            darks       0.91      0.85      0.88       759
                            flats       0.87      0.94      0.90       674
                        deep_sky       0.96      0.96      0.96      3177
                    flat_dados       0.96      0.89      0.93        57
                spectrum_dados       0.96      0.94      0.95        69
    wavelength_calibration_dados       1.00      0.86      0.93        51
                    flat_baches       1.00      0.96      0.98       155
                spectrum_baches       0.77      0.61      0.68        33
    wavelength_calibration_baches       1.00      1.00      1.00        40
                    einsteinturm       0.98      1.00      0.99        81

                        accuracy                           0.94      5136
                        macro avg       0.95      0.90      0.92      5136
                    weighted avg       0.94      0.94      0.94      5136


    Detailed Confusion Matrix Analysis:

    bias:
    True Positives: 35
    False Positives: 0
    False Negatives: 5
    True Negatives: 5096
    Most confused with:
        - Predicted as darks: 3 times
        - Predicted as einsteinturm: 2 times

    darks:
    True Positives: 644
    False Positives: 65
    False Negatives: 115
    True Negatives: 4312
    Most confused with:
        - Misclassified as darks: 3 times
        - Predicted as flats: 5 times
        - Misclassified as darks: 40 times
        - Predicted as deep_sky: 110 times
        - Misclassified as darks: 21 times
        - Misclassified as darks: 1 times

    flats:
    True Positives: 634
    False Positives: 94
    False Negatives: 40
    True Negatives: 4368
    Most confused with:
        - Predicted as darks: 40 times
        - Misclassified as flats: 5 times
        - Misclassified as flats: 89 times

    deep_sky:
    True Positives: 3065
    False Positives: 136
    False Negatives: 112
    True Negatives: 1823
    Most confused with:
        - Predicted as darks: 21 times
        - Misclassified as deep_sky: 110 times
        - Predicted as flats: 89 times
        - Predicted as flat_dados: 1 times
        - Misclassified as deep_sky: 5 times
        - Predicted as spectrum_dados: 1 times
        - Misclassified as deep_sky: 3 times
        - Misclassified as deep_sky: 6 times
        - Misclassified as deep_sky: 12 times

    flat_dados:
    True Positives: 51
    False Positives: 2
    False Negatives: 6
    True Negatives: 5077
    Most confused with:
        - Predicted as deep_sky: 5 times
        - Misclassified as flat_dados: 1 times
        - Predicted as spectrum_dados: 1 times
        - Misclassified as flat_dados: 1 times

    spectrum_dados:
    True Positives: 65
    False Positives: 3
    False Negatives: 4
    True Negatives: 5064
    Most confused with:
        - Predicted as darks: 1 times
        - Predicted as deep_sky: 3 times
        - Misclassified as spectrum_dados: 1 times
        - Misclassified as spectrum_dados: 1 times
        - Misclassified as spectrum_dados: 1 times
        wavelength_calibration_dados:
    True Positives: 44
    False Positives: 0
    False Negatives: 7
    True Negatives: 5085
    Most confused with:
        - Predicted as deep_sky: 6 times
        - Predicted as flat_dados: 1 times

    flat_baches:
    True Positives: 149
    False Positives: 0
    False Negatives: 6
    True Negatives: 4981
    Most confused with:
        - Predicted as spectrum_baches: 6 times

    spectrum_baches:
    True Positives: 20
    False Positives: 6
    False Negatives: 13
    True Negatives: 5097
    Most confused with:
        - Predicted as deep_sky: 12 times
        - Predicted as spectrum_dados: 1 times
        - Misclassified as spectrum_baches: 6 times

    wavelength_calibration_baches:
    True Positives: 40
    False Positives: 0
    False Negatives: 0
    True Negatives: 5096

    einsteinturm:
    True Positives: 81
    False Positives: 2
    False Negatives: 0
    True Negatives: 5053
    Most confused with:
        - Misclassified as einsteinturm: 2 times

    Analyzing feature importance...

    Top 10 Most Important Features:
        Feature  Importance
    6    feature_6   27.339476
    13  feature_13   23.746357
    14  feature_14   21.012796
    17  feature_17   20.969875
    16  feature_16   19.259537
    15  feature_15    2.532271
    3    feature_3    2.402775
    4    feature_4    2.376689
    12  feature_12    2.315243
    19  feature_19    1.993798

    {
    "bias": {
        "best_f1_threshold": 0.9237220883369446,
        "best_f1": 0.9333333333333333,
        "precision_at_best": 1.0,
        "recall_at_best": 0.875
    },
    "darks": {
        "best_f1_threshold": 0.9020980000495911,
        "best_f1": 0.8705234159779615,
        "precision_at_best": 0.911976911976912,
        "recall_at_best": 0.8326745718050066
    },
    "flats": {
        "best_f1_threshold": 0.9256075620651245,
        "best_f1": 0.9043853342918764,
        "precision_at_best": 0.8772663877266388,
        "recall_at_best": 0.9332344213649851
    },
    "deep_sky": {
        "best_f1_threshold": 0.025278756394982338,
        "best_f1": 0.9587628865979382,
        "precision_at_best": 0.9516279069767442,
        "recall_at_best": 0.9660056657223796
    },
    "flat_dados": {
        "best_f1_threshold": 0.08399984240531921,
        "best_f1": 0.9107142857142856,
        "precision_at_best": 0.9272727272727272,
        "recall_at_best": 0.8947368421052632
    },
    "spectrum_dados": {
        "best_f1_threshold": 0.8885483741760254,
        "best_f1": 0.9552238805970149,
        "precision_at_best": 0.9846153846153847,
        "recall_at_best": 0.927536231884058
    },
    "wavelength_calibration_dados": {
        "best_f1_threshold": 0.0374458022415638,
        "best_f1": 0.9702970297029702,
        "precision_at_best": 0.98,
        "recall_at_best": 0.9607843137254902
    },
    "flat_baches": {
        "best_f1_threshold": 0.08005587756633759,
        "best_f1": 0.9810126582278481,
        "precision_at_best": 0.9627329192546584,
        "recall_at_best": 1.0
    },
    "spectrum_baches": {
        "best_f1_threshold": 0.35908302664756775,
        "best_f1": 0.6779661016949152,
        "precision_at_best": 0.7692307692307693,
        "recall_at_best": 0.6060606060606061
    },
    "wavelength_calibration_baches": {
        "best_f1_threshold": 0.8163366317749023,
        "best_f1": 1.0,
        "precision_at_best": 1.0,
        "recall_at_best": 1.0
    },
    "einsteinturm": {
        "best_f1_threshold": 0.9319108724594116,
        "best_f1": 1.0,
        "precision_at_best": 1.0,
        "recall_at_best": 1.0
    }
    }

* python main.py   --data_dir ../image_classification_training_sample   --target_w 448 --target_h 448 --batch_size 24 --epochs 30   --loss_strategy class_weights --cw_beta 0.3 --cw_cap 4.0   --label_smoothing 0.08 --initial_lr 1e-3 --batch_ref 32   --lr_schedule cosine --warmup_epochs 5   --augment --aug_strength 0.4   --aug_conservative 'darks,flats,spectrum_dados,wavelength_calibration_dados,wavelength_calibration_baches'   --randaug_n 2 --randaug_m 5   --mixup_alpha 0.2   --balanced_sampling --balance_cap 4.0   --model_out multimodal_classifier_mixup_warmup_randaug.keras

* python evaluate_model.py   --model_path multimodal_classifier_mixup_warmup_randaug.keras   --data_dir ../image_classification_test_sample   --target_w 448 --target_h 448   --tta --fit_temperature   --auto_threshold max_f1   --pr_out_dir pr_curves_mixup   --save_thresholds thresholds_mixup.json

    Fitted temperature T=0.700 (NLL=0.2491)
    Saved threshold suggestions to: thresholds_mixup.json

    Overall accuracy (argmax): 0.9073
    Overall accuracy (thresholded): 0.9607

    Per-class accuracy:
    bias: 0.8750
    darks: 0.9038
    flats: 0.9303
    deep_sky: 0.9902
    flat_dados: 0.7719
    spectrum_dados: 0.9275
    wavelength_calibration_dados: 0.8431
    flat_baches: 0.9613
    spectrum_baches: 0.5758
    wavelength_calibration_baches: 1.0000
    einsteinturm: 1.0000

    Classification Report:
                                precision    recall  f1-score   support

                            bias       1.00      0.88      0.93        40
                            darks       0.89      0.90      0.90       759
                            flats       1.00      0.93      0.96       674
                        deep_sky       0.97      0.99      0.98      3177
                    flat_dados       1.00      0.77      0.87        57
                spectrum_dados       0.91      0.93      0.92        69
    wavelength_calibration_dados       1.00      0.84      0.91        51
                    flat_baches       1.00      0.96      0.98       155
                spectrum_baches       0.73      0.58      0.64        33
    wavelength_calibration_baches       1.00      1.00      1.00        40
                    einsteinturm       0.99      1.00      0.99        81

                        accuracy                           0.96      5136
                        macro avg       0.95      0.89      0.92      5136
                    weighted avg       0.96      0.96      0.96      5136


    Detailed Confusion Matrix Analysis:

    bias:
    True Positives: 35
    False Positives: 0
    False Negatives: 5
    True Negatives: 5096
    Most confused with:
        - Predicted as darks: 2 times
        - Predicted as deep_sky: 3 times

    darks:
    True Positives: 686
    False Positives: 83
    False Negatives: 73
    True Negatives: 4294
    Most confused with:
        - Misclassified as darks: 2 times
        - Predicted as flats: 3 times
        - Misclassified as darks: 47 times
        - Predicted as deep_sky: 70 times
        - Misclassified as darks: 31 times
        - Misclassified as darks: 1 times
        - Misclassified as darks: 2 times

    flats:
    True Positives: 627
    False Positives: 3
    False Negatives: 47
    True Negatives: 4459
    Most confused with:
        - Predicted as darks: 47 times
        - Misclassified as flats: 3 times

    deep_sky:
    True Positives: 3146
    False Positives: 102
    False Negatives: 31
    True Negatives: 1857
    Most confused with:
        - Misclassified as deep_sky: 3 times
        - Predicted as darks: 31 times
        - Misclassified as deep_sky: 70 times
        - Misclassified as deep_sky: 6 times
        - Misclassified as deep_sky: 4 times
        - Misclassified as deep_sky: 8 times
        - Misclassified as deep_sky: 11 times

    flat_dados:
    True Positives: 44
    False Positives: 0
    False Negatives: 13
    True Negatives: 5079
    Most confused with:
        - Predicted as darks: 1 times
        - Predicted as deep_sky: 6 times
        - Predicted as spectrum_dados: 5 times
        - Predicted as einsteinturm: 1 times

    spectrum_dados:
    True Positives: 64
    False Positives: 6
    False Negatives: 5
    True Negatives: 5061
    Most confused with:
        - Predicted as deep_sky: 4 times
        - Misclassified as spectrum_dados: 5 times
        - Predicted as spectrum_baches: 1 times
        - Misclassified as spectrum_dados: 1 times

    wavelength_calibration_dados:
    True Positives: 43
    False Positives: 0
    False Negatives: 8
    True Negatives: 5085
    Most confused with:
        - Predicted as deep_sky: 8 times

    flat_baches:
    True Positives: 149
    False Positives: 0
    False Negatives: 6
    True Negatives: 4981
    Most confused with:
        - Predicted as spectrum_baches: 6 times

    spectrum_baches:
    True Positives: 19
    False Positives: 7
    False Negatives: 14
    True Negatives: 5096
    Most confused with:
        - Predicted as darks: 2 times
        - Predicted as deep_sky: 11 times
        - Predicted as spectrum_dados: 1 times
        - Misclassified as spectrum_baches: 1 times
        - Misclassified as spectrum_baches: 6 times

    wavelength_calibration_baches:
    True Positives: 40
    False Positives: 0
    False Negatives: 0
    True Negatives: 5096

    einsteinturm:
    True Positives: 81
    False Positives: 1
    False Negatives: 0
    True Negatives: 5054
    Most confused with:
        - Misclassified as einsteinturm: 1 times

    Analyzing feature importance...

    Top 10 Most Important Features:
        Feature  Importance
    14  feature_14   29.789577
    13  feature_13   26.406689
    17  feature_17   26.200384
    6    feature_6   25.948248
    16  feature_16   19.955873
    4    feature_4    2.602888
    15  feature_15    2.007652
    12  feature_12    1.954370
    7    feature_7    1.863487
    1    feature_1    1.689726
    {
    "bias": {
        "best_f1_threshold": 0.11893255263566971,
        "best_f1": 0.9500000000000001,
        "precision_at_best": 0.95,
        "recall_at_best": 0.95
    },
    "darks": {
        "best_f1_threshold": 0.5624731183052063,
        "best_f1": 0.8990825688073395,
        "precision_at_best": 0.894393741851369,
        "recall_at_best": 0.9038208168642952
    },
    "flats": {
        "best_f1_threshold": 0.8827224969863892,
        "best_f1": 0.9638739431206764,
        "precision_at_best": 1.0,
        "recall_at_best": 0.93026706231454
    },
    "deep_sky": {
        "best_f1_threshold": 0.17390429973602295,
        "best_f1": 0.9740678226177688,
        "precision_at_best": 0.9502994011976048,
        "recall_at_best": 0.9990557129367328
    },
    "flat_dados": {
        "best_f1_threshold": 0.03573504090309143,
        "best_f1": 0.918918918918919,
        "precision_at_best": 0.9444444444444444,
        "recall_at_best": 0.8947368421052632
    },
    "spectrum_dados": {
        "best_f1_threshold": 0.5763415098190308,
        "best_f1": 0.920863309352518,
        "precision_at_best": 0.9142857142857143,
        "recall_at_best": 0.927536231884058
    },
    "wavelength_calibration_dados": {
        "best_f1_threshold": 0.1635752022266388,
        "best_f1": 0.9375,
        "precision_at_best": 1.0,
        "recall_at_best": 0.8823529411764706
    },
    "flat_baches": {
        "best_f1_threshold": 0.04712358117103577,
        "best_f1": 0.9935897435897436,
        "precision_at_best": 0.9872611464968153,
        "recall_at_best": 1.0
    },
    "spectrum_baches": {
        "best_f1_threshold": 0.011998387984931469,
        "best_f1": 0.6585365853658536,
        "precision_at_best": 0.5510204081632653,
        "recall_at_best": 0.8181818181818182
    },
    "wavelength_calibration_baches": {
        "best_f1_threshold": 0.6226755976676941,
        "best_f1": 1.0,
        "precision_at_best": 1.0,
        "recall_at_best": 1.0
    },
    "einsteinturm": {
        "best_f1_threshold": 0.8644269704818726,
        "best_f1": 1.0,
        "precision_at_best": 1.0,
        "recall_at_best": 1.0
    }
    }

* python main.py   --data_dir ../image_classification_training_sample   --target_w 448 --target_h 448 --batch_size 24 --epochs 30   --loss_strategy class_weights --cw_beta 0.3 --cw_cap 4.0   --label_smoothing 0.08 --initial_lr 1e-3 --batch_ref 32   --lr_schedule cosine --warmup_epochs 5   --augment --aug_strength 0.3   --aug_conservative 'flat_dados,darks,flats,spectrum_dados,wavelength_calibration_dados,wavelength_calibration_baches'   --randaug_n 2 --randaug_m 5   --mixup_alpha 0.1   --balanced_sampling --balance_cap 4.0   --model_out multimodal_classifier_mixup_warmup_randaug_2.keras

* python evaluate_model.py   --model_path multimodal_classifier_mixup_warmup_randaug_2.keras   --data_dir ../image_classification_test_sample   --target_w 448 --target_h 448   --tta --fit_temperature   --auto_threshold max_f1   --pr_out_dir pr_curves_mixup_2   --save_thresholds thresholds_mixup_2.json

    Fitted temperature T=0.700 (NLL=0.2444)
    Saved threshold suggestions to: thresholds_mixup_2.json

    Overall accuracy (argmax): 0.9262
    Overall accuracy (thresholded): 0.9620

    Per-class accuracy:
    bias: 0.8750
    darks: 0.8986
    flats: 0.9303
    deep_sky: 0.9915
    flat_dados: 0.8596
    spectrum_dados: 0.9420
    wavelength_calibration_dados: 0.8431
    flat_baches: 0.9613
    spectrum_baches: 0.6061
    wavelength_calibration_baches: 1.0000
    einsteinturm: 1.0000

    Classification Report:
                                precision    recall  f1-score   support

                            bias       1.00      0.88      0.93        40
                            darks       0.90      0.90      0.90       759
                            flats       1.00      0.93      0.96       674
                        deep_sky       0.97      0.99      0.98      3177
                    flat_dados       1.00      0.86      0.92        57
                spectrum_dados       0.94      0.94      0.94        69
    wavelength_calibration_dados       1.00      0.84      0.91        51
                    flat_baches       1.00      0.96      0.98       155
                spectrum_baches       0.77      0.61      0.68        33
    wavelength_calibration_baches       1.00      1.00      1.00        40
                    einsteinturm       0.98      1.00      0.99        81

                        accuracy                           0.96      5136
                        macro avg       0.96      0.90      0.93      5136
                    weighted avg       0.96      0.96      0.96      5136


    Detailed Confusion Matrix Analysis:

    bias:
    True Positives: 35
    False Positives: 0
    False Negatives: 5
    True Negatives: 5096
    Most confused with:
        - Predicted as darks: 2 times
        - Predicted as deep_sky: 3 times

    darks:
    True Positives: 682
    False Positives: 74
    False Negatives: 77
    True Negatives: 4303
    Most confused with:
        - Misclassified as darks: 2 times
        - Misclassified as darks: 47 times
        - Predicted as deep_sky: 77 times
        - Misclassified as darks: 24 times
        - Misclassified as darks: 1 times

    flats:
    True Positives: 627
    False Positives: 1
    False Negatives: 47
    True Negatives: 4461
    Most confused with:
        - Predicted as darks: 47 times
        - Misclassified as flats: 1 times

    deep_sky:
    True Positives: 3150
    False Positives: 108
    False Negatives: 27
    True Negatives: 1851
    Most confused with:
        - Misclassified as deep_sky: 3 times
        - Predicted as darks: 24 times
        - Misclassified as deep_sky: 77 times
        - Misclassified as deep_sky: 4 times
        - Predicted as spectrum_dados: 1 times
        - Misclassified as deep_sky: 4 times
        - Misclassified as deep_sky: 8 times
        - Misclassified as deep_sky: 12 times
        - Predicted as einsteinturm: 2 times

    flat_dados:
    True Positives: 49
    False Positives: 0
    False Negatives: 8
    True Negatives: 5079
    Most confused with:
        - Predicted as flats: 1 times
        - Predicted as deep_sky: 4 times
        - Predicted as spectrum_dados: 3 times

    spectrum_dados:
    True Positives: 65
    False Positives: 4
    False Negatives: 4
    True Negatives: 5063
    Most confused with:
        - Predicted as deep_sky: 4 times
        - Misclassified as spectrum_dados: 1 times
        - Misclassified as spectrum_dados: 3 times

    wavelength_calibration_dados:
    True Positives: 43
    False Positives: 0
    False Negatives: 8
    True Negatives: 5085
    Most confused with:
        - Predicted as deep_sky: 8 times

    flat_baches:
    True Positives: 149
    False Positives: 0
    False Negatives: 6
    True Negatives: 4981
    Most confused with:
        - Predicted as spectrum_baches: 6 times

    spectrum_baches:
    True Positives: 20
    False Positives: 6
    False Negatives: 13
    True Negatives: 5097
    Most confused with:
        - Predicted as darks: 1 times
        - Predicted as deep_sky: 12 times
        - Misclassified as spectrum_baches: 6 times

    wavelength_calibration_baches:
    True Positives: 40
    False Positives: 0
    False Negatives: 0
    True Negatives: 5096

    einsteinturm:
    True Positives: 81
    False Positives: 2
    False Negatives: 0
    True Negatives: 5053
    Most confused with:
        - Misclassified as einsteinturm: 2 times

    Analyzing feature importance...

    Top 10 Most Important Features:
        Feature  Importance
    13  feature_13   39.795048
    6    feature_6   33.176914
    17  feature_17   23.303015
    16  feature_16   17.888666
    14  feature_14   14.366660
    4    feature_4    1.914599
    7    feature_7    1.851962
    15  feature_15    1.822474
    3    feature_3    1.764070
    11  feature_11    1.423205


    {
    "bias": {
        "best_f1_threshold": 0.9901419281959534,
        "best_f1": 0.9333333333333333,
        "precision_at_best": 1.0,
        "recall_at_best": 0.875
    },
    "darks": {
        "best_f1_threshold": 0.716075599193573,
        "best_f1": 0.8998009289980092,
        "precision_at_best": 0.9064171122994652,
        "recall_at_best": 0.8932806324110671
    },
    "flats": {
        "best_f1_threshold": 0.9694665670394897,
        "best_f1": 0.963076923076923,
        "precision_at_best": 1.0,
        "recall_at_best": 0.9287833827893175
    },
    "deep_sky": {
        "best_f1_threshold": 0.2720969617366791,
        "best_f1": 0.9791796146674954,
        "precision_at_best": 0.9668610003068426,
        "recall_at_best": 0.9918161787850173
    },
    "flat_dados": {
        "best_f1_threshold": 0.060956865549087524,
        "best_f1": 0.9541284403669724,
        "precision_at_best": 1.0,
        "recall_at_best": 0.9122807017543859
    },
    "spectrum_dados": {
        "best_f1_threshold": 0.822476863861084,
        "best_f1": 0.9253731343283582,
        "precision_at_best": 0.9538461538461539,
        "recall_at_best": 0.8985507246376812
    },
    "wavelength_calibration_dados": {
        "best_f1_threshold": 0.3517951965332031,
        "best_f1": 0.9375,
        "precision_at_best": 1.0,
        "recall_at_best": 0.8823529411764706
    },
    "flat_baches": {
        "best_f1_threshold": 0.7616928815841675,
        "best_f1": 0.9802631578947368,
        "precision_at_best": 1.0,
        "recall_at_best": 0.9612903225806452
    },
    "spectrum_baches": {
        "best_f1_threshold": 0.15800350904464722,
        "best_f1": 0.6779661016949152,
        "precision_at_best": 0.7692307692307693,
        "recall_at_best": 0.6060606060606061
    },
    "wavelength_calibration_baches": {
        "best_f1_threshold": 0.8065952062606812,
        "best_f1": 1.0,
        "precision_at_best": 1.0,
        "recall_at_best": 1.0
    },
    "einsteinturm": {
        "best_f1_threshold": 0.21905045211315155,
        "best_f1": 0.9878048780487805,
        "precision_at_best": 0.9759036144578314,
        "recall_at_best": 1.0
    }
    }


* python evaluate_model.py --model_path multimodal_classifier_mixup_warmup_randaug_2.keras   --data_dir ../image_classification_test_sample --target_w 448 --target_h 448   --tta --temperature 0.7 --thresholds thresholds_prod_precision.json

    Overall accuracy (argmax): 0.9262
    Overall accuracy (thresholded): 0.9459

    Per-class accuracy:
    bias: 0.8750
    darks: 0.8999
    flats: 0.9303
    deep_sky: 0.9657
    flat_dados: 0.8596
    spectrum_dados: 0.9420
    wavelength_calibration_dados: 0.8431
    flat_baches: 0.9613
    spectrum_baches: 0.5455
    wavelength_calibration_baches: 1.0000
    einsteinturm: 1.0000

    Classification Report:
                                precision    recall  f1-score   support

                            bias       1.00      0.88      0.93        40
                            darks       0.81      0.90      0.85       759
                            flats       1.00      0.93      0.96       674
                        deep_sky       0.97      0.97      0.97      3177
                    flat_dados       1.00      0.86      0.92        57
                spectrum_dados       0.92      0.94      0.93        69
    wavelength_calibration_dados       1.00      0.84      0.91        51
                    flat_baches       1.00      0.96      0.98       155
                spectrum_baches       0.75      0.55      0.63        33
    wavelength_calibration_baches       1.00      1.00      1.00        40
                    einsteinturm       0.98      1.00      0.99        81

                        accuracy                           0.95      5136
                        macro avg       0.95      0.89      0.92      5136
                    weighted avg       0.95      0.95      0.95      5136


    Detailed Confusion Matrix Analysis:

    bias:
    True Positives: 35
    False Positives: 0
    False Negatives: 5
    True Negatives: 5096
    Most confused with:
        - Predicted as darks: 2 times
        - Predicted as deep_sky: 3 times

    darks:
    True Positives: 683
    False Positives: 157
    False Negatives: 76
    True Negatives: 4220
    Most confused with:
        - Misclassified as darks: 2 times
        - Misclassified as darks: 47 times
        - Predicted as deep_sky: 76 times
        - Misclassified as darks: 106 times
        - Misclassified as darks: 1 times
        - Misclassified as darks: 1 times

    flats:
    True Positives: 627
    False Positives: 1
    False Negatives: 47
    True Negatives: 4461
    Most confused with:
        - Predicted as darks: 47 times
        - Misclassified as flats: 1 times

    deep_sky:
    True Positives: 3068
    False Positives: 106
    False Negatives: 109
    True Negatives: 1853
    Most confused with:
        - Misclassified as deep_sky: 3 times
        - Predicted as darks: 106 times
        - Misclassified as deep_sky: 76 times
        - Misclassified as deep_sky: 4 times
        - Predicted as spectrum_dados: 1 times
        - Misclassified as deep_sky: 3 times
        - Misclassified as deep_sky: 8 times
        - Misclassified as deep_sky: 12 times
        - Predicted as einsteinturm: 2 times

    flat_dados:
    True Positives: 49
    False Positives: 0
    False Negatives: 8
    True Negatives: 5079
    Most confused with:
        - Predicted as flats: 1 times
        - Predicted as deep_sky: 4 times
        - Predicted as spectrum_dados: 3 times

    spectrum_dados:
    True Positives: 65
    False Positives: 6
    False Negatives: 4
    True Negatives: 5061
    Most confused with:
        - Predicted as darks: 1 times
        - Predicted as deep_sky: 3 times
        - Misclassified as spectrum_dados: 1 times
        - Misclassified as spectrum_dados: 3 times
        - Misclassified as spectrum_dados: 2 times

    wavelength_calibration_dados:
    True Positives: 43
    False Positives: 0
    False Negatives: 8
    True Negatives: 5085
    Most confused with:
        - Predicted as deep_sky: 8 times


    flat_baches:
    True Positives: 149
    False Positives: 0
    False Negatives: 6
    True Negatives: 4981
    Most confused with:
        - Predicted as spectrum_baches: 6 times

    spectrum_baches:
    True Positives: 18
    False Positives: 6
    False Negatives: 15
    True Negatives: 5097
    Most confused with:
        - Predicted as darks: 1 times
        - Predicted as deep_sky: 12 times
        - Predicted as spectrum_dados: 2 times
        - Misclassified as spectrum_baches: 6 times

    wavelength_calibration_baches:
    True Positives: 40
    False Positives: 0
    False Negatives: 0
    True Negatives: 5096

    einsteinturm:
    True Positives: 81
    False Positives: 2
    False Negatives: 0
    True Negatives: 5053
    Most confused with:
        - Misclassified as einsteinturm: 2 times

    Analyzing feature importance...

    Top 10 Most Important Features:
        Feature  Importance
    13  feature_13   39.795048
    6    feature_6   33.176914
    17  feature_17   23.303015
    16  feature_16   17.888666
    14  feature_14   14.366660
    4    feature_4    1.914599
    7    feature_7    1.851962
    15  feature_15    1.822474
    3    feature_3    1.764070
    11  feature_11    1.423205


* python evaluate_model.py   --model_path multimodal_classifier_mixup_warmup_randaug_2.keras   --data_dir ../image_classification_test_sample   --target_w 448 --target_h 448   --tta --temperature 0.7   --thresholds 0.990,0.880,0.969,0.240,0.061,0.822,0.352,0.762,0.200,0.807,0.219

    Overall accuracy (argmax): 0.9262
    Overall accuracy (thresholded): 0.9589

    Per-class accuracy:
    bias: 0.8750
    darks: 0.8775
    flats: 0.9303
    deep_sky: 0.9918
    flat_dados: 0.8596
    spectrum_dados: 0.9420
    wavelength_calibration_dados: 0.8431
    flat_baches: 0.9613
    spectrum_baches: 0.5758
    wavelength_calibration_baches: 1.0000
    einsteinturm: 1.0000

    Classification Report:
                                precision    recall  f1-score   support

                            bias       1.00      0.88      0.93        40
                            darks       0.90      0.88      0.89       759
                            flats       1.00      0.93      0.96       674
                        deep_sky       0.96      0.99      0.98      3177
                    flat_dados       1.00      0.86      0.92        57
                spectrum_dados       0.93      0.94      0.94        69
    wavelength_calibration_dados       1.00      0.84      0.91        51
                    flat_baches       1.00      0.96      0.98       155
                spectrum_baches       0.76      0.58      0.66        33
    wavelength_calibration_baches       1.00      1.00      1.00        40
                    einsteinturm       0.98      1.00      0.99        81

                        accuracy                           0.96      5136
                        macro avg       0.96      0.90      0.92      5136
                    weighted avg       0.96      0.96      0.96      5136


    Detailed Confusion Matrix Analysis:

    bias:
    True Positives: 35
    False Positives: 0
    False Negatives: 5
    True Negatives: 5096
    Most confused with:
        - Predicted as darks: 2 times
        - Predicted as deep_sky: 3 times

    darks:
    True Positives: 666
    False Positives: 73
    False Negatives: 93
    True Negatives: 4304
    Most confused with:
        - Misclassified as darks: 2 times
        - Misclassified as darks: 47 times
        - Predicted as deep_sky: 93 times
        - Misclassified as darks: 23 times
        - Misclassified as darks: 1 times

    flats:
    True Positives: 627
    False Positives: 1
    False Negatives: 47
    True Negatives: 4461
    Most confused with:
        - Predicted as darks: 47 times
        - Misclassified as flats: 1 times

    deep_sky:
    True Positives: 3151
    False Positives: 124
    False Negatives: 26
    True Negatives: 1835
    Most confused with:
        - Misclassified as deep_sky: 3 times
        - Predicted as darks: 23 times
        - Misclassified as deep_sky: 93 times
        - Misclassified as deep_sky: 4 times
        - Predicted as spectrum_dados: 1 times
        - Misclassified as deep_sky: 4 times
        - Misclassified as deep_sky: 8 times
        - Misclassified as deep_sky: 12 times
        - Predicted as einsteinturm: 2 times

    flat_dados:
    True Positives: 49
    False Positives: 0
    False Negatives: 8
    True Negatives: 5079
    Most confused with:
        - Predicted as flats: 1 times
        - Predicted as deep_sky: 4 times
        - Predicted as spectrum_dados: 3 times

    spectrum_dados:
    True Positives: 65
    False Positives: 5
    False Negatives: 4
    True Negatives: 5062
    Most confused with:
        - Predicted as deep_sky: 4 times
        - Misclassified as spectrum_dados: 1 times
        - Misclassified as spectrum_dados: 3 times
        - Misclassified as spectrum_dados: 1 times

        wavelength_calibration_dados:
    True Positives: 43
    False Positives: 0
    False Negatives: 8
    True Negatives: 5085
    Most confused with:
        - Predicted as deep_sky: 8 times

    flat_baches:
    True Positives: 149
    False Positives: 0
    False Negatives: 6
    True Negatives: 4981
    Most confused with:
        - Predicted as spectrum_baches: 6 times

    spectrum_baches:
    True Positives: 19
    False Positives: 6
    False Negatives: 14
    True Negatives: 5097
    Most confused with:
        - Predicted as darks: 1 times
        - Predicted as deep_sky: 12 times
        - Predicted as spectrum_dados: 1 times
        - Misclassified as spectrum_baches: 6 times

    wavelength_calibration_baches:
    True Positives: 40
    False Positives: 0
    False Negatives: 0
    True Negatives: 5096

    einsteinturm:
    True Positives: 81
    False Positives: 2
    False Negatives: 0
    True Negatives: 5053
    Most confused with:
        - Misclassified as einsteinturm: 2 times

    Analyzing feature importance...

    Top 10 Most Important Features:
        Feature  Importance
    13  feature_13   39.795048
    6    feature_6   33.176914
    17  feature_17   23.303015
    16  feature_16   17.888666
    14  feature_14   14.366660
    4    feature_4    1.914599
    7    feature_7    1.851962
    15  feature_15    1.822474
    3    feature_3    1.764070
    11  feature_11    1.423205

* python evaluate_model.py   --model_path multimodal_classifier_mixup_warmup_randaug_2.keras   --data_dir ../image_classification_test_sample   --target_w 448 --target_h 448   --tta --temperature 0.7   --thresholds 0.990,0.880,0.969,0.240,0.061,0.822,0.352,0.762,0.170,0.807,0.219

    Overall accuracy (argmax): 0.9262
    Overall accuracy (thresholded): 0.9589

    Per-class accuracy:
    bias: 0.8750
    darks: 0.8775
    flats: 0.9303
    deep_sky: 0.9918
    flat_dados: 0.8596
    spectrum_dados: 0.9420
    wavelength_calibration_dados: 0.8431
    flat_baches: 0.9613
    spectrum_baches: 0.5758
    wavelength_calibration_baches: 1.0000
    einsteinturm: 1.0000

    Classification Report:
                                precision    recall  f1-score   support

                            bias       1.00      0.88      0.93        40
                            darks       0.90      0.88      0.89       759
                            flats       1.00      0.93      0.96       674
                        deep_sky       0.96      0.99      0.98      3177
                    flat_dados       1.00      0.86      0.92        57
                spectrum_dados       0.93      0.94      0.94        69
    wavelength_calibration_dados       1.00      0.84      0.91        51
                    flat_baches       1.00      0.96      0.98       155
                spectrum_baches       0.76      0.58      0.66        33
    wavelength_calibration_baches       1.00      1.00      1.00        40
                    einsteinturm       0.98      1.00      0.99        81

                        accuracy                           0.96      5136
                        macro avg       0.96      0.90      0.92      5136
                    weighted avg       0.96      0.96      0.96      5136


    Detailed Confusion Matrix Analysis:

    bias:
    True Positives: 35
    False Positives: 0
    False Negatives: 5
    True Negatives: 5096
    Most confused with:
        - Predicted as darks: 2 times
        - Predicted as deep_sky: 3 times

    darks:
    True Positives: 666
    False Positives: 73
    False Negatives: 93
    True Negatives: 4304
    Most confused with:
        - Misclassified as darks: 2 times
        - Misclassified as darks: 47 times
        - Predicted as deep_sky: 93 times
        - Misclassified as darks: 23 times
        - Misclassified as darks: 1 times

    flats:
    True Positives: 627
    False Positives: 1
    False Negatives: 47
    True Negatives: 4461
    Most confused with:
        - Predicted as darks: 47 times
        - Misclassified as flats: 1 times

    deep_sky:
    True Positives: 3151
    False Positives: 124
    False Negatives: 26
    True Negatives: 1835
    Most confused with:
        - Misclassified as deep_sky: 3 times
        - Predicted as darks: 23 times
        - Misclassified as deep_sky: 93 times
        - Misclassified as deep_sky: 4 times
        - Predicted as spectrum_dados: 1 times
        - Misclassified as deep_sky: 4 times
        - Misclassified as deep_sky: 8 times
        - Misclassified as deep_sky: 12 times
        - Predicted as einsteinturm: 2 times

    flat_dados:
    True Positives: 49
    False Positives: 0
    False Negatives: 8
    True Negatives: 5079
    Most confused with:
        - Predicted as flats: 1 times
        - Predicted as deep_sky: 4 times
        - Predicted as spectrum_dados: 3 times

    spectrum_dados:
    True Positives: 65
    False Positives: 5
    False Negatives: 4
    True Negatives: 5062
    Most confused with:
        - Predicted as deep_sky: 4 times
        - Misclassified as spectrum_dados: 1 times
        - Misclassified as spectrum_dados: 3 times
        - Misclassified as spectrum_dados: 1 times

    wavelength_calibration_dados:
    True Positives: 43
    False Positives: 0
    False Negatives: 8
    True Negatives: 5085
    Most confused with:
        - Predicted as deep_sky: 8 times

    flat_baches:
    True Positives: 149
    False Positives: 0
    False Negatives: 6
    True Negatives: 4981
    Most confused with:
        - Predicted as spectrum_baches: 6 times

    spectrum_baches:
    True Positives: 19
    False Positives: 6
    False Negatives: 14
    True Negatives: 5097
    Most confused with:
        - Predicted as darks: 1 times
        - Predicted as deep_sky: 12 times
        - Predicted as spectrum_dados: 1 times
        - Misclassified as spectrum_baches: 6 times

    wavelength_calibration_baches:
    True Positives: 40
    False Positives: 0
    False Negatives: 0
    True Negatives: 5096

    einsteinturm:
    True Positives: 81
    False Positives: 2
    False Negatives: 0
    True Negatives: 5053
    Most confused with:
        - Misclassified as einsteinturm: 2 times

    Analyzing feature importance...

    Top 10 Most Important Features:
        Feature  Importance
    13  feature_13   39.795048
    6    feature_6   33.176914
    17  feature_17   23.303015
    16  feature_16   17.888666
    14  feature_14   14.366660
    4    feature_4    1.914599
    7    feature_7    1.851962
    15  feature_15    1.822474
    3    feature_3    1.764070
    11  feature_11    1.423205


* python evaluate_model.py       --model_path multimodal_classifier_mixup_warmup_randaug_2.keras       --data_dir ../image_classification_test_sample       --target_w 448 --target_h 448       --tta --temperature 0.7       --thresholds thresholds_prod_precision.json       --abstain_unknown

    Overall accuracy (argmax): 0.9262
    Overall coverage: 0.9836
    Accuracy@coverage: 0.9650
    Overall accuracy (unknown counted incorrect): 0.9492

    Per-class accuracy:
    bias: 0.8750
    darks: 0.8235
    flats: 0.9288
    deep_sky: 0.9918
    flat_dados: 0.8596
    spectrum_dados: 0.8986
    wavelength_calibration_dados: 0.8431
    flat_baches: 0.9548
    spectrum_baches: 0.5758
    wavelength_calibration_baches: 0.9000
    einsteinturm: 1.0000
    unknown (abstained): reported separately via coverage/accuracy@coverage

    Classification Report:
                                precision    recall  f1-score   support

                            bias       1.00      0.88      0.93        40
                            darks       0.94      0.87      0.90       718
                            flats       1.00      0.94      0.97       666
                        deep_sky       0.96      1.00      0.98      3153
                    flat_dados       1.00      0.88      0.93        56
                spectrum_dados       0.95      0.94      0.95        66
    wavelength_calibration_dados       1.00      0.84      0.91        51
                    flat_baches       1.00      0.96      0.98       154
                spectrum_baches       0.76      0.61      0.68        31
    wavelength_calibration_baches       1.00      1.00      1.00        36
                    einsteinturm       0.98      1.00      0.99        81

                        accuracy                           0.96      5052
                        macro avg       0.96      0.90      0.93      5052
                    weighted avg       0.96      0.96      0.96      5052


    Detailed Confusion Matrix Analysis:

    bias:
    True Positives: 35
    False Positives: 0
    False Negatives: 5
    True Negatives: 5096
    Most confused with:
        - Predicted as darks: 2 times
        - Predicted as deep_sky: 3 times

    darks:
    True Positives: 625
    False Positives: 42
    False Negatives: 134
    True Negatives: 4335
    Most confused with:
        - Misclassified as darks: 2 times
        - Misclassified as darks: 40 times
        - Predicted as deep_sky: 93 times
        - Predicted as unknown: 41 times

    flats:
    True Positives: 626
    False Positives: 0
    False Negatives: 48
    True Negatives: 4462
    Most confused with:
        - Predicted as darks: 40 times
        - Predicted as unknown: 8 times

    deep_sky:
    True Positives: 3151
    False Positives: 124
    False Negatives: 26
    True Negatives: 1835
    Most confused with:
        - Misclassified as deep_sky: 3 times
        - Misclassified as deep_sky: 93 times
        - Misclassified as deep_sky: 4 times
        - Misclassified as deep_sky: 4 times
        - Misclassified as deep_sky: 8 times
        - Misclassified as deep_sky: 12 times
        - Predicted as einsteinturm: 2 times
        - Predicted as unknown: 24 times
        flat_dados:
    True Positives: 49
    False Positives: 0
    False Negatives: 8
    True Negatives: 5079
    Most confused with:
        - Predicted as deep_sky: 4 times
        - Predicted as spectrum_dados: 3 times
        - Predicted as unknown: 1 times

    spectrum_dados:
    True Positives: 62
    False Positives: 3
    False Negatives: 7
    True Negatives: 5064
    Most confused with:
        - Predicted as deep_sky: 4 times
        - Misclassified as spectrum_dados: 3 times
        - Predicted as unknown: 3 times

    wavelength_calibration_dados:
    True Positives: 43
    False Positives: 0
    False Negatives: 8
    True Negatives: 5085
    Most confused with:
        - Predicted as deep_sky: 8 times

    flat_baches:
    True Positives: 148
    False Positives: 0
    False Negatives: 7
    True Negatives: 4981
    Most confused with:
        - Predicted as spectrum_baches: 6 times
        - Predicted as unknown: 1 times

    spectrum_baches:
    True Positives: 19
    False Positives: 6
    False Negatives: 14
    True Negatives: 5097
    Most confused with:
        - Predicted as deep_sky: 12 times
        - Misclassified as spectrum_baches: 6 times
        - Predicted as unknown: 2 times

    wavelength_calibration_baches:
    True Positives: 36
    False Positives: 0
    False Negatives: 4
    True Negatives: 5096
    Most confused with:
        - Predicted as unknown: 4 times

    einsteinturm:
    True Positives: 81
    False Positives: 2
    False Negatives: 0
    True Negatives: 5053
    Most confused with:
        - Misclassified as einsteinturm: 2 times

    unknown:
    True Positives: 0
    False Positives: 84
    False Negatives: 0
    True Negatives: 5052
    Most confused with:
        - Misclassified as unknown: 41 times
        - Misclassified as unknown: 8 times
        - Misclassified as unknown: 24 times
        - Misclassified as unknown: 1 times
        - Misclassified as unknown: 3 times
        - Misclassified as unknown: 1 times
        - Misclassified as unknown: 2 times
        - Misclassified as unknown: 4 times

    Analyzing feature importance...

    Top 10 Most Important Features:
        Feature  Importance
    13  feature_13   39.795048
    6    feature_6   33.176914
    17  feature_17   23.303015
    16  feature_16   17.888666
    14  feature_14   14.366660
    4    feature_4    1.914599
    7    feature_7    1.851962
    15  feature_15    1.822474
    3    feature_3    1.764070
    11  feature_11    1.423205
